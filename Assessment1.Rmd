---
title: "Peer Assessment 1"
author: "Sergio Siqueira"
date: "August 9, 2014"
output: html_document
---

This Reproducible Research Coursera course first assessment is based on data from Activity Monitoring Data file on the Github repository. The original file is compressed so it needs to be 'unzipped' to the R Studio working directory before load the .csv data file into the R environment to be processed.

The following code will perform these three steps:  
- Check if the file is into working directory, if not: issue a message, if yes, then  
- Uncompress the file into the same directory  
- Load the .csv file into R Studio and assure the date format

```{r, echo = TRUE}
## Check if file exists in working directory, if not then print a message asking to download the file to current WD
if (!file.exists("activity.zip")) {
      print("File 'activity.zip' does not exist in working directory, please download the file")
}

## Unzip the file, load into R and make sure date format
unzip("activity.zip")
activity <- read.csv("activity.csv", header = T, sep = ",")
activity$date <- as.Date(activity$date, format = "%Y-%m-%d")
```

Once data is loaded, sum steps for each day and discard the 'NA' values

```{r, echo = TRUE}
## Sum of steps per day while removing NA values
steps_day <- rowsum(activity$steps, activity$date, reorder = F, na.rm = T)
hist(steps_day, main = "Histogram of Steps per Day")
abline(v = mean(steps_day), col = "red", lwd = 2)
abline(v = median(steps_day), col = "blue", lwd = 2)
legend("topright", c(paste("Mean    =   ", round(mean(steps_day))), paste("Median = ", median(steps_day))), 
       col = c("red", "blue"), lwd = 2)
```

Now plot the time series: steps mean by 5-minute intervals on each day

```{r, echo = TRUE}
# Removing NA from steps in activity dataframe
na_steps <- is.na(activity$steps)
aux_activity <- activity
aux_activity <- aux_activity[!na_steps, , ]
interval_steps <- split(aux_activity$steps, aux_activity$interval)
mean_steps <- lapply(interval_steps, mean)
max_value <- max(unlist(lapply(mean_steps, max)))
plot(names(mean_steps), mean_steps, type = "l", main = "Mean steps per interval",
     sub = paste("Maximum mean steps = ", max_value), xlab = "Time Intervals", ylab = "Mean steps")
```

